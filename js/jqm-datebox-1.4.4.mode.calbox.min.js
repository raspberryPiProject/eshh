/*! jQuery-Mobile-DateBox  |2014-10-03T17:22:11Z | (c) 2010,  2014 JTSage | https://github.com/jtsage/jquery-mobile-datebox/blob/master/LICENSE.txt */
!function(a){a.extend(a.mobile.datebox.prototype.options,{themeDateToday:"b",themeDayHigh:"b",themeDatePick:"b",themeDateHigh:"b",themeDateHighAlt:"b",themeDateHighRec:"b",themeDate:"a",calHighToday:!0,calHighPick:!0,calShowDays:!0,calOnlyMonth:!1,calWeekMode:!1,calWeekModeDay:1,calControlGroup:!1,calShowWeek:!1,calUsePickers:!1,calNoHeader:!1,calYearPickMin:-6,calYearPickMax:6,useTodayButton:!1,useTomorrowButton:!1,useCollapsedBut:!1,highDays:!1,highDates:!1,highDatesRec:!1,highDatesAlt:!1,enableDates:!1,calDateList:!1,calShowDateList:!1}),a.extend(a.mobile.datebox.prototype,{_cal_gen:function(a,b,c,d,e){var f=0,g=0,h=1,i=1,j=[],k=[],l=!1;for(f=0;5>=f;f++)if(l===!1){for(k=[],g=0;6>=g;g++)0===f&&a>g?k.push(d===!0?[b+(g-a)+1,e-1]:!1):f>3&&h>c?(d===!0?(k.push([i,e+1]),i++):k.push(!1),l=!0):(k.push([h,e]),h++,h>c&&(l=!0));j.push(k)}return j},_cal_check:function(b,c,d,e,f){var g,h=this,i=this.options,j=f.x,k=f.i,l=f.t,m=f.p,n=new this._date(c,d,e,0,0,0,0).getDay(),o=i.blackDatesRec,p=i.highDatesRec,q={ok:!0,iso:c+"-"+h._zPad(d+1)+"-"+h._zPad(e),theme:i.themeDate,recok:!0,rectheme:!1};if(q.comp=parseInt(q.iso.replace(/-/g,""),10),o!==!1)for(g=0;g<o.length;g++)-1!==o[g][0]&&o[g][0]!==c||-1!==o[g][1]&&o[g][1]!==d||-1!==o[g][2]&&o[g][2]!==e||(q.ok=!1);if(a.isArray(i.enableDates)&&a.inArray(q.iso,i.enableDates)<0?q.ok=!1:b&&(q.recok!==!0||i.afterToday&&l.comp()>q.comp||i.beforeToday&&l.comp()<q.comp||i.notToday&&l.comp()===q.comp||i.maxDays!==!1&&j.comp()<q.comp||i.minDays!==!1&&k.comp()>q.comp||a.isArray(i.blackDays)&&a.inArray(n,i.blackDays)>-1||a.isArray(i.blackDates)&&a.inArray(q.iso,i.blackDates)>-1)&&(q.ok=!1),a.isArray(i.whiteDates)&&a.inArray(q.iso,i.whiteDates)>-1&&(q.ok=!0),q.ok){if(p!==!1)for(g=0;g<p.length;g++)-1!==p[g][0]&&p[g][0]!==c||-1!==p[g][1]&&p[g][1]!==d||-1!==p[g][2]&&p[g][2]!==e||(q.rectheme=!0);!i.calHighPick||e!==m||""===h.d.input.val()&&i.defaultValue===!1?i.calHighToday&&q.comp===l.comp()?q.theme=i.themeDateToday:a.isArray(i.highDatesAlt)&&a.inArray(q.iso,i.highDatesAlt)>-1?q.theme=i.themeDateHighAlt:a.isArray(i.highDates)&&a.inArray(q.iso,i.highDates)>-1?q.theme=i.themeDateHigh:a.isArray(i.highDays)&&a.inArray(n,i.highDays)>-1?q.theme=i.themeDayHigh:a.isArray(i.highDatesRec)&&q.rectheme===!0&&(q.theme=i.themeDateHighRec):q.theme=i.themeDatePick}return q}}),a.extend(a.mobile.datebox.prototype._build,{calbox:function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=this.options,r=q.calDateList,s="ui-datebox-",t=p.theDate,u=!1,v={},w=p.initDate.copy(),x=p.initDate.copy(),y=(t.copy([0],[0,0,1]).getDay()-p.__("calStartDay")+7)%7,z=t.get(1),A=t.get(0),B=t.getArray(),C=""===p.d.input.val()?p._startOffset(p._makeDate(p.d.input.val())):p._makeDate(p.d.input.val()),D=-1,E=new p._date,F=E.getArray(),G=t.copy([0],[0,0,1]).adj(2,-1*y+(0===p.__("calStartDay")?1:0)).getDWeek(4),H=0,I=!1,J=!1,K=32-p.theDate.copy([0],[0,0,32,13]).getDate(),L=32-p.theDate.copy([0,-1],[0,0,32,13]).getDate(),M=q.afterToday||q.beforeToday||q.notToday||q.maxDays||q.minDays||q.blackDays||q.blackDates?!0:!1;if("boolean"!=typeof p.d.intHTML&&(p.d.intHTML.remove(),p.d.intHTML=null),p.d.headerText=p._grabLabel()!==!1?p._grabLabel():p.__("titleDateDialogLabel"),p.d.intHTML=a("<span>"),a("<div class='"+s+"gridheader'><div class='"+s+"gridlabel'><h4>"+p._formatter(p.__("calHeaderFormat"),p.theDate)+"</h4></div></div>").appendTo(p.d.intHTML),a("<div class='"+s+"gridplus"+(p.__("isRTL")?"-rtl":"")+"'><a href='#'>"+p.__("nextMonth")+"</a></div>").prependTo(p.d.intHTML.find("."+s+"gridheader")).find("a").addClass("ui-btn-inline ui-link ui-btn ui-btn-"+q.themeDate+" ui-icon-plus ui-btn-icon-notext ui-shadow ui-corner-all").on(q.clickEventAlt,function(a){a.preventDefault(),p.calNext&&(p.theDate.getDate()>28&&p.theDate.setDate(1),p._offset("m",1))}),a("<div class='"+s+"gridminus"+(p.__("isRTL")?"-rtl":"")+"'><a href='#'>"+p.__("prevMonth")+"</a></div>").prependTo(p.d.intHTML.find("."+s+"gridheader")).find("a").addClass("ui-btn-inline ui-link ui-btn ui-btn-"+q.themeDate+" ui-icon-minus ui-btn-icon-notext ui-shadow ui-corner-all").on(q.clickEventAlt,function(a){a.preventDefault(),p.calPrev&&(p.theDate.getDate()>28&&p.theDate.setDate(1),p._offset("m",-1))}),q.calNoHeader&&p.d.intHTML.find("."+s+"gridheader").remove(),p.calNext=!0,p.calPrev=!0,Math.floor(E.comp()/100)===Math.floor(t.comp()/100)&&(I=!0),Math.floor(E.comp()/1e4)===Math.floor(t.comp()/1e4)&&(J=!0),C.comp()===t.comp()&&(D=C.get(2)),q.afterToday&&(I||J&&F[1]>=B[1])&&(p.calPrev=!1),q.beforeToday&&(I||J&&F[1]<=B[1])&&(p.calNext=!1),q.minDays!==!1&&(w.adj(2,-1*q.minDays),b=w.getArray(),B[0]===b[0]&&B[1]<=b[1]&&(p.calPrev=!1)),q.maxDays!==!1&&(x.adj(2,q.maxDays),b=w.getArray(),B[0]===b[0]&&B[1]>=b[1]&&(p.calNext=!1)),q.calUsePickers){for(c=a("<div>",{"class":"ui-grid-a ui-datebox-grid",style:"padding-top: 5px; padding-bottom: 5px;"}),c.a=a("<div class='ui-block-a'><select></select></div>").appendTo(c).find("select"),c.b=a("<div class='ui-block-b'><select></select></div>").appendTo(c).find("select"),m=0;11>=m;m++)c.a.append(a("<option value='"+m+"'"+(z===m?" selected='selected'":"")+">"+p.__("monthsOfYear")[m]+"</option>"));for(n=q.calYearPickMin<1?A+q.calYearPickMin:q.calYearPickMin<1800?A-q.calYearPickMin:"NOW"===q.calYearPickMin?F[0]:q.calYearPickMin,o=q.calYearPickMax<1800?A+q.calYearPickMax:"NOW"===q.calYearPickMax?F[0]:q.calYearPickMax,m=n;o>=m;m++)c.b.append(a("<option value='"+m+"'"+(A===m?" selected='selected'":"")+">"+m+"</option>"));c.a.on("change",function(){p.theDate.setD(1,a(this).val()),p.theDate.get(1)!==parseInt(a(this).val(),10)&&p.theDate.setD(2,0),p.refresh()}),c.b.on("change",function(){p.theDate.setD(0,a(this).val()),p.theDate.get(1)!==parseInt(c.a.val(),10)&&p.theDate.setD(2,0),p.refresh()}),c.find("select").selectmenu({mini:!0,nativeMenu:!0}),c.appendTo(p.d.intHTML)}if(d=a("<div class='"+s+"grid'>").appendTo(p.d.intHTML),q.calShowDays)for(p._cal_days=p.__("daysOfWeekShort").concat(p.__("daysOfWeekShort")),f=a("<div>",{"class":s+"gridrow"}).appendTo(d),q.calControlGroup&&f.addClass(s+"gridrow-last"),p.__("isRTL")===!0&&f.css("direction","rtl"),q.calShowWeek&&a("<div>").addClass(s+"griddate "+s+"griddate-label").appendTo(f),m=0;6>=m;m++)a("<div>").text(p._cal_days[(m+p.__("calStartDay"))%7]).addClass(s+"griddate "+s+"griddate-label").appendTo(f);for(v={i:w,x:x,t:E,p:D},e=p._cal_gen(y,L,K,!q.calOnlyMonth,t.get(1)),h=0,j=e.length;j>h;h++){for(l=a("<div>",{"class":s+"gridrow"}),p.__("isRTL")&&l.css("direction","rtl"),q.calShowWeek&&(a("<div>",{"class":s+"griddate "+s+"griddate-empty"}).text("W"+G).css(q.calControlGroup?{"float":"left"}:{}).appendTo(l),G++,G>52&&"undefined"!=typeof e[h+1]&&(G=new p._date(B[0],B[1],0===p.__("calStartDay")?e[h+1][1][0]:e[h+1][0][0],0,0,0,0).getDWeek(4))),i=0,k=e[h].length;k>i;i++)q.calWeekMode&&(H=e[h][q.calWeekModeDay][0]),"boolean"==typeof e[h][i]?a("<div>",{"class":s+"griddate "+s+"griddate-empty"}).appendTo(l):(u=p._cal_check(M,B[0],e[h][i][1],e[h][i][0],v),e[h][i][0]&&a("<div>").text(String(e[h][i][0])).addClass(s+"griddate ui-corner-all ui-btn").addClass(z===e[h][i][1]?"ui-btn-"+u.theme+(u.ok?"":" ui-state-disabled"):s+"griddate-empty").css(z===e[h][i][1]||q.calOnlyMonth?{}:{cursor:"pointer"}).data("date",q.calWeekMode?H:e[h][i][0]).data("enabled",u.ok).data("month",e[h][q.calWeekMode?q.calWeekModeDay:i][1]).appendTo(l));q.calControlGroup&&l.controlgroup({type:"horizontal"}),h===j-1&&l.addClass(s+"gridrow-last"),l.appendTo(d)}if(q.calShowWeek&&d.find("."+s+"griddate").addClass(s+"griddate-week"),q.calShowDateList&&r!==!1){for(g=a("<div>"),g.a=a("<select name='pickdate'></select>").appendTo(g),g.a.append("<option value='false' selected='selected'>"+p.__("calDateListLabel")+"</option>"),m=0;m<r.length;m++)g.a.append(a("<option value='"+r[m][0]+"'>"+r[m][1]+"</option>"));g.a.on("change",function(){b=a(this).val().split("-"),p.theDate=new p._date(b[0],b[1]-1,b[2],0,0,0,0),p._t({method:"doset"})}),g.find("select").selectmenu({mini:!0,nativeMenu:!0}),g.appendTo(d)}(q.useTodayButton||q.useTomorrowButton||q.useClearButton)&&(l=a("<div>",{"class":s+"controls"}),q.useTodayButton&&a("<a href='#' role='button'>"+p.__("calTodayButtonLabel")+"</a>").appendTo(l).addClass("ui-btn ui-btn-"+q.theme+" ui-icon-navigation ui-btn-icon-left ui-shadow ui-corner-all").on(q.clickEvent,function(a){a.preventDefault(),p.theDate=p._pa([0,0,0],new p._date),p._t({method:"doset"})}),q.useTomorrowButton&&a("<a href='#' role='button'>"+p.__("calTomorrowButtonLabel")+"</a>").appendTo(l).addClass("ui-btn ui-btn-"+q.theme+" ui-icon-navigation ui-btn-icon-left ui-shadow ui-corner-all").on(q.clickEvent,function(a){a.preventDefault(),p.theDate=p._pa([0,0,0],new p._date).adj(2,1),p._t({method:"doset"})}),q.useClearButton&&l.append(p._stdBtn.clear.apply(p)),q.useCollapsedBut?(l.controlgroup({type:"horizontal"}),l.addClass("ui-datebox-collapse")):l.controlgroup(),l.appendTo(d)),p.d.intHTML.on(q.clickEventAlt,"div."+s+"griddate",function(b){b.preventDefault(),a(this).data("enabled")&&(p.theDate.setD(2,1).setD(1,a(this).jqmData("month")).setD(2,a(this).data("date")),p._t({method:"set",value:p._formatter(p.__fmt(),p.theDate),date:p.theDate}),p._t({method:"close"}))}),p.d.intHTML.on("swipeleft",function(){p.calNext&&p._offset("m",1)}).on("swiperight",function(){p.calPrev&&p._offset("m",-1)}),p.wheelExists&&p.d.intHTML.on("mousewheel",function(a,b){a.preventDefault(),b>0&&p.calNext&&(p.theDate.setD(2,1),p._offset("m",1)),0>b&&p.calPrev&&(p.theDate.setD(2,1),p._offset("m",-1))})}})}(jQuery);